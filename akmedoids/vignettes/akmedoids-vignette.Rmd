---
title: "`Akmedoids` R-package for longitudinal dataset: application to the clustering of long-term inequalities in micro-area exposure to crime"
author: "Adepeju, M., Langton, S., and Bannister, J."
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
#output: pdf_document
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

<style type="text/css">

h1.title {
  font-size: 18px;
  color: Black;
  text-align: center;
}
h4.author { /* Header 4 - and the author and data headers use this too  */
    font-size: 12px;
  font-family: "Arial", Times, serif;
  color: Black;
  text-align: center;
}
h4.date { /* Header 4 - and the author and data headers use this too  */
  font-size: 12px;
  font-family: "Arial", Times, serif;
  color: Black;
  text-align: center;
}

h4.abstract { /* Header 4 - and the author and data headers use this too  */
  font-size: 12px;
  font-family: "Arial", Times, serif;
  color: red;
  text-align: center;
}

body, td {
   font-size: 11px;
}
code.r{
  font-size: 10px;
}
pre {
  font-size: 11px
}
h1 { /* Header 1 */
  font-size: 14px;
  color: DarkBlue;
}
h2 { /* Header 2 */
    font-size: 12px;
  color: DarkBlue;
}
h3 { /* Header 3 */
  font-size: 11px;
  font-family: "Times New Roman", Times, serif;
  color: DarkBlue;

</style>

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

\begin{abstract}
The `akmedoids` advances a set of R-functions for longitudinal clustering of trajectories based on the similarities of their long-term trends and determines the optimal solution based on the Calinski-Harabatz criterion (Calinski and Harabatz, 1974). The package also include a number of other useful functions for exploring and manipulating longitudinal data prior to the clustering process.
\end{abstract}

# Introduction
Longitudinal clustering analysis play a prominent role in social and behavioral sciences for understanding the developmental processes  of a subject over time. blah blah blah!

Data collection, feature and need for dat cleaning. 

Purpose: The goal of this document is to provide a description of these functions and demonstrate how they can be used in a real application. Examples provided throughout this document should allow easy uptake of this package in any field. The functions are divided into two categories as follow:


## 1. `Data manipulation` functions
Table 1 shows the key functions under this category and their descriptions. Prior to an actual clustering analysis, the `data manipulation` functions can be used to address some of the data features, such as `outlier` and `whitespace`, which have the potential to cause errors in the analysis. In other words, these function can be used to get a longitudinal data into a proper shape for an advance analysis.

Below is more detailed description of each function and how they work. For the current demonstration, we employ a simulated dataset `traj` which is provided with the `akmediod` package. The dataset can be accessed by typing `traj` in R console and can also be found in the library folder under `akmedoids/data/traj.rda`. 

```{r, echo=FALSE, include=FALSE}
require(knitr)
library(flextable)
library(kableExtra)
col1 <- c("1", "2","3","4")
col2 <- c("`dataImputation`","`outlierDetect`","`wSpaces`", "`props`")
col3 <- c("Data imputation for longitudinal data","Outlier detection and replacement","Whitespaces removal", "Conversion of counts (or rates) to 'Proportion'")
col4 <- c("Calculates any missing entries (`NA`, `Inf`, `null`) in a longitudinal data, according to a specified method","Identifies outlier observations in the data, and replace or remove them","Removes all the leading and trailing whitespaces in a longitudinal data","Converts counts or rates observation to 'proportion'")
tble <- data.frame(col1, col2, col3, col4)
tble <- tble
```

```{r, results='asis', echo=FALSE, tidy.opts=list(width.cutoff=50)}
knitr::kable(tble, caption = "`Data manipulation` functions", col.names = c("SN","Function","Title","Description")) %>%
  kable_styling(full_width = F) %>%
  column_spec(1, bold = T, border_right = T) %>%
  column_spec(2, width = "8em", background = "white") %>%
  column_spec(3, width = "12em", background = "white") %>%
  column_spec(4, width = "16em", background = "white")#%>%
  #row_spec(3:5, bold = T, color = "white", background = "#D7261E")
```

### (i) `dataImputation`:
This function calculates any missing entries (such as `NA`, `Inf`, `null`) in a data, according to a specified method. See examle below:

```{r, eval=TRUE}
#reading the data
traj <- read.table(file="C:/demo/traj.csv", sep=",", head=TRUE)
#preview the data
head(traj)
nrow(traj) #no. of rows
ncol(traj) #no. of columns
```

`traj` dataset contains a number of missing values which might have not been observed (such as in the case of `NA`) or have resulted due to a calculation error (such as in the case of `Inf`). The `dataImputation` function can be used to replace these entries based on the values of other cells. Two methods are proposed. First, an `arithmetic` method which uses the `mean`, `minimum` or `maximum` value from the corresponding rows or columns in which the missing values are located. A user decides what option is most appropriate for the data at hand. Second, a `regression` method which uses a linear regression line to estimate the missing values on a line. are found and then estimates their values. Note that only the missing data points derive values from the regression line while the rest of the data points retain their original values. The function terminates if there are trajectories with only one observation. Below is a demonstration of how the `regression` option will estimate the missing values of the `traj` dataset. 

```{r, eval=TRUE}
#reading the data
traj <- read.table(file="C:/demo/traj.csv", sep=",", head=TRUE)
#preview the data
head(traj)
nrow(traj) #no. of rows
ncol(traj) #no. of columns
```



### Special application - `generating population estimates between two census years` 
The `dataImputation` function can useful for interpolating the population estimating the population information population data.


